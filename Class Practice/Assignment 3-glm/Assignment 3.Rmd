---
title: "Assignment 3 -glm"
author: "Andrew Abisha Hu"
date: "9/5/2018"
output: html_document
---

A marketing research company conduct a survey to investigate consumers’ willingness to
try anew energy drink. Download energy.csv on Canvas and answer the following
questions. Here is the description of variables:

```
sex: sex of the respondent (0 = female, 1 = male)
age: age group of the respondent (10-19, 20-29, 30-39)
exercise: self-reported exercise frequency (0 = less than twice/week, 1 = at least
twice/week)
innovation: a composite index of the respondent’s tendency to try new things
user: energy drink user (0 = never drink any energy drink, 1 = others)
try: try the new energy drink after reading its advertising flyer (0 = no, 1 = yes)
train: training data set (if TURE)
cv: indicators for 5-fold cross validation (data sets 0 - 4)
```

1. Use only the training data set to run a Probit model. Predict try by all other
variables except for train and cv. (provide R codes, 0.5%)

```{r}
library(car)
library(pROC)
setwd("/Users/andrewhu/Documents/GitHub/Machine-Learning/Class Practice/Assignment 3-glm")
energy <- read.csv("energy.csv")
baseball <- read.csv("baseball.csv")

fit = glm( try~sex+age + exercise+ innovation +user, data= energy, family=binomial(link="probit"), subset= (train==T))
```


2. Compute p-value for the overall model significant. (provide R codes, 0.3%)

```{r}
1- pchisq(fit$null.deviance- fit$deviance, 6)
```


3. Based on the p-value, what is your conclusion? (0.2%)
```
We can reject the null hypothesis → we conclude that at least one variable has a significant effect on the model.
```

4. Now use the test data set (i.e., non-training data set) to compute the classification
rate. You consider that a respondent will try the new energy drink if the predicted
probability is at least 0.5. (provide R codes, 0.5%)

```{r}
tab= table(energy$try[energy$train==FALSE],predict(fit,energy[energy$train==FALSE,], type="response")>.5)
sum(diag(tab))/ sum(tab)
```

5. You suspect that males who exercise at least twice per week may be more likely to try the new product than other males. How will you expand the Probit model to test your hypothesis? (provide R codes, 0.5%)

```{r}
fit2 = glm(try~sex +age+ exercise + innovation + user +sex* exercise, data=energy, family=binomial(link="probit"), subset=c(train==T))
```

6. What is the 99% confidence interval of the coefficient of the new variable you
added? Based on the confidence interval, what is your conclusion? (provide R codes,
0.5%)

```{r}
confint(fit2, level=.99)
```

```
[0.1650906, 0.7871330] → does not include 0, so we can conclude that at the 0.01 level,
there is a significant difference between males who exercise at least twice per week and
males who exercise less than twice a week.
```

7. Find AIC of the two models. Based on AIC, would you prefer the original model or
the expanded one? (0.5%)

```
AIC of original model: 2451.3
AIC of expanded model: 2437.7
The expanded model is better than the original model as it has a lower AIC. Also, the
difference of their AIC is larger than 10, which is a strong evidence in favor of the lower
AIC model (the expanded model)
```

8. Now use the test data set (i.e., non-training data set) and compute the classification
rate of the expanded model. You consider that a respondent will try the new energy
drink if the predicted probability is at least 0.5. (provide R codes, 0.5%)

```{r}
tab2 = table(energy[energy$train==FALSE,]$try, predict(fit2, energy[energy$train==FALSE,], type= "response")>.5)
sum(diag(tab2))/sum(tab2)
```

9. Use the test data set to create ROC plots and compute AUC for both models.
(provide R codes, 0.5%)

```{r}
plot.roc(energy$try[energy$train==F], predict(fit,energy[energy$train==F,],type="response"), data=energy, legacy.axes=T, print.auc=T, print.auc.x=1, print.auc.y=.9)

plot.roc(energy$try[energy$train==F], predict(fit2,energy[energy$train==F,],type="response"), data=energy, add=T,col=2, print.auc=T, print.auc.x=.5, print.auc.y=.4, print.auc.col=2)

```